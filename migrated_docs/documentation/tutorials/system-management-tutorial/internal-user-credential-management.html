<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Agave Developer Docs</title>
    <link rel="shortcut icon" type="image/x-icon" href="images/favicon.ico">


    <!-- <script src="https://use.typekit.net/squ8frf.js"></script>
    <script>try{Typekit.load({ async: true });}catch(e){}</script> -->

    <link href="../../../../stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="../../../../stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <link rel="preload" href="fonts/slate.woff" as="font">
    <link rel="preload" href="fonts/agave.woff" as="font">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <!-- <script src="../../../../javascripts/jquery.min.js" type="text/javascript"></script> -->

      <script src="../../../../javascripts/all_nosearch.js" type="text/javascript"></script>
    <script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-43163231-12', 'auto');
ga('require', 'eventTracker');
ga('require', 'outboundLinkTracker');
ga('require', 'urlChangeTracker');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script src="../../../../javascripts/autotrack.js" type="text/javascript" async="true"></script>

    <style>
    .js #fouc { display: none; }
    </style>
    <script type="text/javascript">
        document.documentElement.className = 'js';
    </script>
  </head>

  <body class="migrated_docs migrated_docs_documentation migrated_docs_documentation_tutorials migrated_docs_documentation_tutorials_system-management-tutorial migrated_docs_documentation_tutorials_system-management-tutorial_internal-user-credential-management">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../../../../images/navbar.png" />
      </span>
    </a>
    <div id="fouc">
        <div class="tocify-wrapper">
          <img class="menu-logo" src="../../../../images/agave-docs-logo.png" />
          
          <div id="toc">
          </div>
        </div>
        <div class="page-wrapper">
          <div class="dark-box"></div>
          <div class="content">
            <h2 id="introduction">Introduction</h2>

<p>The systems you create are private to you. If you changed nothing else from the examples in the <a href="http://agaveapi.co/documentation/tutorials/system-management/" title="System Management">System Management</a> tutorial, you would have a shared storage resource which your client application could use to host data for all your application users. Such a setup is often referred to as a <em>community account</em> because a single account is used by an entire community of people.</p>

<p>One challenge that comes with using community accounts is tracking the usage of individual users. Such fine-grained accounting is both time consuming and difficult to implement. Agave solves this problem for you through its Internal User feature. If you are not familiar with this particular topic, please consult the <a href="http://agaveapi.co/documentation/tutorials/internal-user-management/" title="Internal User Tutorial">Internal User Management</a> tutorial for a detailed introduction.</p>

<p>Even though you share the account among your application users, Agave will still track individual activity, so you can generate reports on the activity of any user you&rsquo;ve created.</p>

<p>If a community account model is not desired, you can skip defining a default credential for the system and instead define credentials for each internal user. In this scenario, you would include a custom header, <code>x-agave-internaluser</code>, specifying the username of the internal user with each request. Agave will pick up on this and the credentials you associated with the internal user on a particular system will be used when interacting with the physical system.</p>

<p>A hybrid model is also possible. Internal user credentials will always be looked for first, however, if none are found, whatever default authentication has been defined for that system will be used. Thus, if you have a situation where you would like to allow some users to share a single account, but then force others to use their own accounts, this would be a model for doing so. Enforcing internal user quotas is left up to the application developer, however internal user usage information can be obtained from the reporting service to facilitate the decision making process.</p>

<h3 id="assigning-a-internal-user-credential-to-a-system">Assigning a internal user credential to a system</h3>
<pre class="highlight shell"><code>curl -sk -H <span class="s2">"Authorization: Bearer </span><span class="nv">$ACCESS_TOKEN</span><span class="s2">"</span> -XPOST --data &amp;#039;<span class="o">{</span><span class="s2">"internal_username"</span>: <span class="s2">"cdavis"</span>, <span class="s2">"username"</span>: <span class="s2">"cdavis"</span>, <span class="s2">"password"</span>: <span class="s2">"changeit"</span>, <span class="s2">"type"</span>: <span class="s2">"PASSWORD"</span>, <span class="s2">"default"</span>: <span class="nb">false</span><span class="o">}</span>&amp;#039; https://<span class="nv">$API_BASE_URL</span>/systems/<span class="nv">$API_VERSION</span>/demo.execute.example.com/credentials/cdavis
</code></pre>
<pre class="highlight plaintext"><code>systems-credentials-addupdate -v -u cdavis -F credential-password.json demo.execute.example.com
</code></pre>

<p>The response from the service will return a JSON array of credentials created for the internal user. This may seem odd that a single POST resulted in multiple credentials. The reason two credentials were returned is that the target system is an execution system, thus is has both a <code>storage.auth</code> and <code>login.auth</code> authentication section. When no credential type is specified in the URL, the credential is applied to both authentication sections.</p>
<pre class="highlight javascript"><code><span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">"created"</span><span class="p">:</span> <span class="s2">"2014-09-23T04:20:16.000-05:00"</span><span class="p">,</span>
    <span class="s2">"default"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="s2">"expirationDate"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"internalUsername"</span><span class="p">:</span> <span class="s2">"cdavis"</span><span class="p">,</span>
    <span class="s2">"parentType"</span><span class="p">:</span> <span class="s2">"LOGIN"</span><span class="p">,</span>
    <span class="s2">"server"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"PASSWORD"</span><span class="p">,</span>
    <span class="s2">"valid"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"_links"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"internalUser"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="p">:</span> <span class="s2">"https://$API_BASE_URL/profiles/$API_VERSION/systest/users/cdavis"</span>
      <span class="p">},</span>
      <span class="s2">"parent"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="err">:</span> <span class="s2">"https://$API_BASE_URL/systems/$API_VERSION/demo.execute.example.com/credentials"</span>
      <span class="p">},</span>
      <span class="s2">"self"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="err">:</span> <span class="s2">"https://$API_BASE_URL/systems/$API_VERSION/demo.execute.example.com/credentials/cdavis/login"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span> 
  <span class="p">{</span>
    <span class="s2">"created"</span><span class="p">:</span> <span class="s2">"2014-09-23T04:20:16.000-05:00"</span><span class="p">,</span>
    <span class="s2">"default"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="s2">"expirationDate"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"internalUsername"</span><span class="p">:</span> <span class="s2">"cdavis"</span><span class="p">,</span>
    <span class="s2">"parentType"</span><span class="p">:</span> <span class="s2">"STORAGE"</span><span class="p">,</span>
    <span class="s2">"server"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"PASSWORD"</span><span class="p">,</span>
    <span class="s2">"valid"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"_links"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"internalUser"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="p">:</span> <span class="s2">"https://$API_BASE_URL/profiles/$API_VERSION/systest/users/cdavis"</span>
      <span class="p">},</span>
      <span class="s2">"parent"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="err">:</span> <span class="s2">"https://$API_BASE_URL/systems/$API_VERSION/demo.execute.example.com/credentials"</span>
      <span class="p">},</span>
      <span class="s2">"self"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="err">:</span> <span class="s2">"https://$API_BASE_URL/systems/$API_VERSION/demo.execute.example.com/credentials/cdavis/storage"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">]</span>
</code></pre>

<p>To set just the storage credential for the internal user, we can append the internal username and type to the URL.</p>
<pre class="highlight shell"><code>curl -sk -H <span class="s2">"Authorization: Bearer </span><span class="nv">$ACCESS_TOKEN</span><span class="s2">"</span> -XPOST --data &amp;#039;<span class="o">{</span><span class="s2">"internal_username"</span>: <span class="s2">"cdavis"</span>, <span class="s2">"username"</span>: <span class="s2">"cdavis"</span>, <span class="s2">"password"</span>: <span class="s2">"changeit"</span>, <span class="s2">"type"</span>: <span class="s2">"PASSWORD"</span>, <span class="s2">"default"</span>: <span class="nb">false</span><span class="o">}</span>&amp;#039; https://<span class="nv">$API_BASE_URL</span>/systems/<span class="nv">$API_VERSION</span>/demo.execute.example.com/credentials/cdavis/storage
</code></pre>
<pre class="highlight plaintext"><code>systems-credentials-addupdate -v -u cdavis -s -F credential-password.json demo.execute.example.com
</code></pre>

<p>The response from the service will return a JSON array with just the newly created credential object.</p>
<pre class="highlight javascript"><code><span class="p">[</span> 
  <span class="p">{</span>
    <span class="s2">"created"</span><span class="p">:</span> <span class="s2">"2014-09-23T04:20:16.000-05:00"</span><span class="p">,</span>
    <span class="s2">"default"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="s2">"expirationDate"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"internalUsername"</span><span class="p">:</span> <span class="s2">"cdavis"</span><span class="p">,</span>
    <span class="s2">"parentType"</span><span class="p">:</span> <span class="s2">"STORAGE"</span><span class="p">,</span>
    <span class="s2">"server"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"PASSWORD"</span><span class="p">,</span>
    <span class="s2">"valid"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"_links"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"internalUser"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="p">:</span> <span class="s2">"https://$API_BASE_URL/profiles/$API_VERSION/systest/users/cdavis"</span>
      <span class="p">},</span>
      <span class="s2">"parent"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="err">:</span> <span class="s2">"https://$API_BASE_URL/systems/$API_VERSION/demo.execute.example.com/credentials"</span>
      <span class="p">},</span>
      <span class="s2">"self"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="err">:</span> <span class="s2">"https://$API_BASE_URL/systems/$API_VERSION/demo.execute.example.com/credentials/cdavis/storage"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">]</span>
</code></pre>

<h3 id="listing-internal-users-with-assigned-credentials">Listing internal users with assigned credentials</h3>

<p>To obtain a listing of internal users with default credentials assigned to them on a particular system, perform a GET on the system credentials collection.</p>
<pre class="highlight shell"><code>curl -sk -H <span class="s2">"Authorization: Bearer </span><span class="nv">$ACCESS_TOKEN</span><span class="s2">"</span> https://<span class="nv">$API_BASE_URL</span>/systems/<span class="nv">$API_VERSION</span>/demo.execute.example.com/credentials
</code></pre>
<pre class="highlight plaintext"><code> systems-credentials-list -v
</code></pre>

<p>The response from the service will be a JSON array of credential objects. Notice that the actual system credentials are not returned. Once assigned, internal user credentials, as with default system credentials, cannot be retrieved.</p>
<pre class="highlight javascript"><code><span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">"created"</span><span class="p">:</span> <span class="s2">"2014-09-23T04:20:16.000-05:00"</span><span class="p">,</span>
    <span class="s2">"default"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="s2">"expirationDate"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"internalUsername"</span><span class="p">:</span> <span class="s2">"cdavis"</span><span class="p">,</span>
    <span class="s2">"parentType"</span><span class="p">:</span> <span class="s2">"LOGIN"</span><span class="p">,</span>
    <span class="s2">"server"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"PASSWORD"</span><span class="p">,</span>
    <span class="s2">"valid"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"_links"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"internalUser"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="p">:</span> <span class="s2">"https://$API_BASE_URL/profiles/$API_VERSION/systest/users/cdavis"</span>
      <span class="p">},</span>
      <span class="s2">"parent"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="err">:</span> <span class="s2">"https://$API_BASE_URL/systems/$API_VERSION/demo.execute.example.com/credentials"</span>
      <span class="p">},</span>
      <span class="s2">"self"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="err">:</span> <span class="s2">"https://$API_BASE_URL/systems/$API_VERSION/demo.execute.example.com/credentials/cdavis/login"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span> 
  <span class="p">{</span>
    <span class="s2">"created"</span><span class="p">:</span> <span class="s2">"2014-09-23T04:20:16.000-05:00"</span><span class="p">,</span>
    <span class="s2">"default"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="s2">"expirationDate"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"internalUsername"</span><span class="p">:</span> <span class="s2">"cdavis"</span><span class="p">,</span>
    <span class="s2">"parentType"</span><span class="p">:</span> <span class="s2">"STORAGE"</span><span class="p">,</span>
    <span class="s2">"server"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"PASSWORD"</span><span class="p">,</span>
    <span class="s2">"valid"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"_links"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"internalUser"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="p">:</span> <span class="s2">"https://$API_BASE_URL/profiles/$API_VERSION/systest/users/cdavis"</span>
      <span class="p">},</span>
      <span class="s2">"parent"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="err">:</span> <span class="s2">"https://$API_BASE_URL/systems/$API_VERSION/demo.execute.example.com/credentials"</span>
      <span class="p">},</span>
      <span class="s2">"self"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="err">:</span> <span class="s2">"https://$API_BASE_URL/systems/$API_VERSION/demo.execute.example.com/credentials/cdavis/storage"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">"parentType"</span> <span class="p">:</span> <span class="s2">"storage"</span><span class="p">,</span>
    <span class="s2">"default"</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"internalUsername"</span> <span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"PASSWORD"</span><span class="p">,</span>
    <span class="s2">"created"</span> <span class="p">:</span> <span class="s2">"2014-01-03T03:21:28.000-06:00"</span><span class="p">,</span>
    <span class="s2">"valid"</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"expirationDate"</span> <span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"server"</span> <span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"_links"</span> <span class="p">:</span> <span class="p">{</span>
      <span class="s2">"self"</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">"href"</span> <span class="p">:</span> <span class="s2">"https://public.agaveapi.co/systems/v2/demo.execute.example.com/credentials/default/storage"</span>
      <span class="p">},</span>
      <span class="s2">"parent"</span> <span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span> <span class="err">:</span> <span class="s2">"https://public.agaveapi.co/systems/v2/demo.execute.example.com/credentials"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span> 
  <span class="p">{</span>
    <span class="s2">"parentType"</span> <span class="p">:</span> <span class="s2">"login"</span><span class="p">,</span>
    <span class="s2">"default"</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"internalUsername"</span> <span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"PASSWORD"</span><span class="p">,</span>
    <span class="s2">"created"</span> <span class="p">:</span> <span class="s2">"2014-01-03T03:21:28.000-06:00"</span><span class="p">,</span>
    <span class="s2">"valid"</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"expirationDate"</span> <span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"server"</span> <span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"_links"</span> <span class="p">:</span> <span class="p">{</span>
      <span class="s2">"self"</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">"href"</span> <span class="p">:</span> <span class="s2">"https://public.agaveapi.co/systems/v2/demo.execute.example.com/credentials/default/login"</span>
      <span class="p">},</span>
      <span class="s2">"parent"</span> <span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span> <span class="err">:</span> <span class="s2">"https://public.agaveapi.co/systems/v2/demo.execute.example.com/credentials"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">]</span>
</code></pre>

<p>Adding the internal username to the URL will return just the credentials for that internal user if present.</p>
<pre class="highlight shell"><code>curl -sk -H <span class="s2">"Authorization: Bearer </span><span class="nv">$ACCESS_TOKEN</span><span class="s2">"</span> https://<span class="nv">$API_BASE_URL</span>/systems/<span class="nv">$API_VERSION</span>/demo.execute.example.com/credentials/cdavis
</code></pre>
<pre class="highlight plaintext"><code> systems-credentials-list -v -u cdavis
</code></pre>
<pre class="highlight javascript"><code><span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">"created"</span><span class="p">:</span> <span class="s2">"2014-09-23T04:20:16.000-05:00"</span><span class="p">,</span>
    <span class="s2">"default"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="s2">"expirationDate"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"internalUsername"</span><span class="p">:</span> <span class="s2">"cdavis"</span><span class="p">,</span>
    <span class="s2">"parentType"</span><span class="p">:</span> <span class="s2">"LOGIN"</span><span class="p">,</span>
    <span class="s2">"server"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"PASSWORD"</span><span class="p">,</span>
    <span class="s2">"valid"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"_links"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"internalUser"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="p">:</span> <span class="s2">"https://$API_BASE_URL/profiles/$API_VERSION/systest/users/cdavis"</span>
      <span class="p">},</span>
      <span class="s2">"parent"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="err">:</span> <span class="s2">"https://$API_BASE_URL/systems/$API_VERSION/demo.execute.example.com/credentials"</span>
      <span class="p">},</span>
      <span class="s2">"self"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="err">:</span> <span class="s2">"https://$API_BASE_URL/systems/$API_VERSION/demo.execute.example.com/credentials/cdavis/login"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span> 
  <span class="p">{</span>
    <span class="s2">"created"</span><span class="p">:</span> <span class="s2">"2014-09-23T04:20:16.000-05:00"</span><span class="p">,</span>
    <span class="s2">"default"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="s2">"expirationDate"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"internalUsername"</span><span class="p">:</span> <span class="s2">"cdavis"</span><span class="p">,</span>
    <span class="s2">"parentType"</span><span class="p">:</span> <span class="s2">"STORAGE"</span><span class="p">,</span>
    <span class="s2">"server"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"PASSWORD"</span><span class="p">,</span>
    <span class="s2">"valid"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"_links"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"internalUser"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="p">:</span> <span class="s2">"https://$API_BASE_URL/profiles/$API_VERSION/systest/users/cdavis"</span>
      <span class="p">},</span>
      <span class="s2">"parent"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="err">:</span> <span class="s2">"https://$API_BASE_URL/systems/$API_VERSION/demo.execute.example.com/credentials"</span>
      <span class="p">},</span>
      <span class="s2">"self"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="err">:</span> <span class="s2">"https://$API_BASE_URL/systems/$API_VERSION/demo.execute.example.com/credentials/cdavis/storage"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">]</span>
</code></pre>

<p>To list the credentials of a specific type, append either <em>storage</em> or <em>login</em> to the previous URL.</p>
<pre class="highlight shell"><code>curl -sk -H <span class="s2">"Authorization: Bearer </span><span class="nv">$ACCESS_TOKEN</span><span class="s2">"</span> https://<span class="nv">$API_BASE_URL</span>/systems/<span class="nv">$API_VERSION</span>/demo.execute.example.com/credentials/cdavis/storage
</code></pre>
<pre class="highlight plaintext"><code> systems-credentials-list -v -u cdavis -s
</code></pre>
<pre class="highlight javascript"><code><span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">"parentType"</span> <span class="p">:</span> <span class="s2">"storage"</span><span class="p">,</span>
    <span class="s2">"default"</span> <span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="s2">"internalUsername"</span> <span class="p">:</span> <span class="s2">"cdavis"</span><span class="p">,</span>
    <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"PASSWORD"</span><span class="p">,</span>
    <span class="s2">"created"</span> <span class="p">:</span> <span class="s2">"2014-09-23T04:20:31.000-05:00"</span><span class="p">,</span>
    <span class="s2">"valid"</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"expirationDate"</span> <span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"server"</span> <span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"_links"</span> <span class="p">:</span> <span class="p">{</span>
      <span class="s2">"self"</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">"href"</span> <span class="p">:</span> <span class="s2">"https://public.agaveapi.co/systems/v2/demo.execute.example.com/credentials/cdavis/storage"</span>
      <span class="p">},</span>
      <span class="s2">"parent"</span> <span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span> <span class="err">:</span> <span class="s2">"https://public.agaveapi.co/systems/v2/demo.execute.example.com/credentials"</span>
      <span class="p">},</span>
      <span class="s2">"internalUser"</span> <span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span> <span class="err">:</span> <span class="s2">"https://public.agaveapi.co/profiles/v2/systest/users/cdavis"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">]</span>
</code></pre>

<h3 id="deleting-internal-user-credentials">Deleting internal user credentials</h3>

<p>To remove internal user credentials, make a DELETE request on the credential&rsquo;s URL.</p>
<pre class="highlight shell"><code>curl -sk -H <span class="s2">"Authorization: Bearer </span><span class="nv">$ACCESS_TOKEN</span><span class="s2">"</span> -X DELETE https://<span class="nv">$API_BASE_URL</span>/systems/<span class="nv">$API_VERSION</span>/demo.execute.example.com/credentials/cdavis/storage
</code></pre>
<pre class="highlight plaintext"><code> systems-credentials-delete -v -u cdavis -s
</code></pre>

<p>An empty response object will be returned. If we then query for the user&rsquo;s credentials again, we will see that the user&rsquo;s storage credential has been replaced with the system default credential.</p>
<pre class="highlight shell"><code>curl -sk -H <span class="s2">"Authorization: Bearer </span><span class="nv">$ACCESS_TOKEN</span><span class="s2">"</span> https://<span class="nv">$API_BASE_URL</span>/systems/<span class="nv">$API_VERSION</span>/demo.execute.example.com/credentials/cdavis
</code></pre>
<pre class="highlight plaintext"><code> systems-credentials-delete -v -u cdavis -S
</code></pre>
<pre class="highlight javascript"><code><span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">"created"</span><span class="p">:</span> <span class="s2">"2014-09-23T04:20:16.000-05:00"</span><span class="p">,</span>
    <span class="s2">"default"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="s2">"expirationDate"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"internalUsername"</span><span class="p">:</span> <span class="s2">"cdavis"</span><span class="p">,</span>
    <span class="s2">"parentType"</span><span class="p">:</span> <span class="s2">"LOGIN"</span><span class="p">,</span>
    <span class="s2">"server"</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"PASSWORD"</span><span class="p">,</span>
    <span class="s2">"valid"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"_links"</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">"internalUser"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="p">:</span> <span class="s2">"https://$API_BASE_URL/profiles/$API_VERSION/systest/users/cdavis"</span>
      <span class="p">},</span>
      <span class="s2">"parent"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="err">:</span> <span class="s2">"https://$API_BASE_URL/systems/$API_VERSION/demo.execute.example.com/credentials"</span>
      <span class="p">},</span>
      <span class="s2">"self"</span><span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span><span class="err">:</span> <span class="s2">"https://$API_BASE_URL/systems/$API_VERSION/demo.execute.example.com/credentials/cdavis/login"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">"parentType"</span> <span class="p">:</span> <span class="s2">"storage"</span><span class="p">,</span>
    <span class="s2">"default"</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"internalUsername"</span> <span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"PASSWORD"</span><span class="p">,</span>
    <span class="s2">"created"</span> <span class="p">:</span> <span class="s2">"2014-01-03T03:21:28.000-06:00"</span><span class="p">,</span>
    <span class="s2">"valid"</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"expirationDate"</span> <span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"server"</span> <span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"_links"</span> <span class="p">:</span> <span class="p">{</span>
      <span class="s2">"self"</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">"href"</span> <span class="p">:</span> <span class="s2">"https://public.agaveapi.co/systems/v2/demo.execute.example.com/credentials/default/storage"</span>
      <span class="p">},</span>
      <span class="s2">"parent"</span> <span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span> <span class="err">:</span> <span class="s2">"https://public.agaveapi.co/systems/v2/demo.execute.example.com/credentials"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">]</span>
</code></pre>

<p>To delete all of the internal user&rsquo;s credentials, omit the type from the URL.</p>
<pre class="highlight shell"><code>curl -sk -H <span class="s2">"Authorization: Bearer </span><span class="nv">$ACCESS_TOKEN</span><span class="s2">"</span> -X DELETE https://<span class="nv">$API_BASE_URL</span>/systems/<span class="nv">$API_VERSION</span>/demo.execute.example.com/credentials/cdavis
</code></pre>
<pre class="highlight plaintext"><code> systems-credentials-delete -v -u cdavis
</code></pre>

<p>Once again the response will be empty. Querying for the internal user credentials will now return just the system defaults.</p>
<pre class="highlight shell"><code>curl -sk -H <span class="s2">"Authorization: Bearer </span><span class="nv">$ACCESS_TOKEN</span><span class="s2">"</span> https://<span class="nv">$API_BASE_URL</span>/systems/<span class="nv">$API_VERSION</span>/demo.execute.example.com/credentials/cdavis
</code></pre>
<pre class="highlight plaintext"><code> systems-credentials-delete -v -u cdavis -S
</code></pre>
<pre class="highlight javascript"><code><span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">"parentType"</span> <span class="p">:</span> <span class="s2">"storage"</span><span class="p">,</span>
    <span class="s2">"default"</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"internalUsername"</span> <span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"PASSWORD"</span><span class="p">,</span>
    <span class="s2">"created"</span> <span class="p">:</span> <span class="s2">"2014-01-03T03:21:28.000-06:00"</span><span class="p">,</span>
    <span class="s2">"valid"</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"expirationDate"</span> <span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"server"</span> <span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"_links"</span> <span class="p">:</span> <span class="p">{</span>
      <span class="s2">"self"</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">"href"</span> <span class="p">:</span> <span class="s2">"https://public.agaveapi.co/systems/v2/demo.execute.example.com/credentials/default/storage"</span>
      <span class="p">},</span>
      <span class="s2">"parent"</span> <span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span> <span class="err">:</span> <span class="s2">"https://public.agaveapi.co/systems/v2/demo.execute.example.com/credentials"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">"parentType"</span> <span class="p">:</span> <span class="s2">"login"</span><span class="p">,</span>
    <span class="s2">"default"</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"internalUsername"</span> <span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"type"</span> <span class="p">:</span> <span class="s2">"PASSWORD"</span><span class="p">,</span>
    <span class="s2">"created"</span> <span class="p">:</span> <span class="s2">"2014-01-03T03:21:28.000-06:00"</span><span class="p">,</span>
    <span class="s2">"valid"</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="s2">"expirationDate"</span> <span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"server"</span> <span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="s2">"_links"</span> <span class="p">:</span> <span class="p">{</span>
      <span class="s2">"self"</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s2">"href"</span> <span class="p">:</span> <span class="s2">"https://public.agaveapi.co/systems/v2/demo.execute.example.com/credentials/default/login"</span>
      <span class="p">},</span>
      <span class="s2">"parent"</span> <span class="err">:</span> <span class="p">{</span>
        <span class="s2">"href"</span> <span class="err">:</span> <span class="s2">"https://public.agaveapi.co/systems/v2/demo.execute.example.com/credentials"</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">]</span>
</code></pre>

<p>Clearing all internal user credentials from a system can be done by omitting the internal username from the URL.</p>
<pre class="highlight shell"><code>curl -sk -H <span class="s2">"Authorization: Bearer </span><span class="nv">$ACCESS_TOKEN</span><span class="s2">"</span> https://<span class="nv">$API_BASE_URL</span>/systems/<span class="nv">$API_VERSION</span>/demo.execute.example.com/credentials/cdavis
</code></pre>
<pre class="highlight plaintext"><code> systems-credentials-delete -v -u cdavis -S
</code></pre>

<p>The response from the service will be empty.</p>

<p>Once you clear all internal user credentials from a system, all internal users requests will again use the default system credentials.</p>

<aside class="notice">Be careful when deleting internal credentials. Doing so can make job and system data created and stored using the internal user&rsquo;s credentials unavailable after deletion.</aside>

          </div>
          <div class="dark-box">
          </div>
        </div>
    </div>
    <script type="text/javascript">
      document.getElementById("fouc").style.display="block";
    </script>
  </body>
</html>
